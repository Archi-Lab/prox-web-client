<div class="project-list">
  <div class="project-list-header">
    <h1>
      Projekte

      <button
        *ngIf="hasPermission"
        (click)="openProjectEditorDialog(null)"
        mat-icon-button
        matTooltip="Neues Projekt hinzufügen"
        class="no-hover"
      >
        <mat-icon>
          add
        </mat-icon>
      </button>
    </h1>

    <div class="left">
      <mat-form-field class="status-search">
        <mat-select
          [formControl]="selectedStatusOption"
          (selectionChange)="getProjects()"
          placeholder="Status"
        >
          <mat-option
            *ngFor="let statusOption of statusOptions | keyvalue"
            [value]="statusOption.value"
          >
            {{ statusOption.value }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="right">
      <mat-icon
        (click)="toggleShowExtendedSearch()"
        matTooltip="Erweiterte Suche"
        class="filter-icon"
      >
        filter_list
      </mat-icon>
    </div>

    <span class="middle">
      <mat-form-field class="search">
        <label>
          <input
            [formControl]="searchString"
            (keydown)="setHasSearchChanged(true)"
            (change)="getProjects()"
            [placeholder]="
              hasSearchChanged
                ? 'Suche (Drücken Sie Enter um die Suche zu bestätigen)'
                : 'Suche'
            "
            matInput
          />
        </label>
      </mat-form-field>
    </span>

    <div *ngIf="showExtendedSearch">
      <mat-card-subtitle>
        <h2>
          <b>
            Erweiterte Suche
            <small>(Profi)</small>
          </b>
        </h2>
      </mat-card-subtitle>

      <p class="description">
        <b>Suchmöglichkeiten:</b>

        Beschreibung, Betreuer, Tag, Titel, Voraussetzung
      </p>

      <ul class="list">
        <li>
          <u>Suche:</u>

          ' Betreuer="Bente" Tag="architektur" Tag="software" '
        </li>

        <li>
          <u>Ergebnis:</u>

          Explizit alle Projekte, die den Betreuer "Bente" sowie die Tags
          "architektur" und "software" enthalten.
        </li>
      </ul>

      <mat-divider></mat-divider>

      <mat-card-subtitle>
        <h2 class="extended-search-title">
          <b>
            Erweiterte Suche

            <small>(Anfänger)</small>
          </b>
        </h2>
      </mat-card-subtitle>

      <div class="left">
        <mat-form-field class="status-search">
          <mat-select
            [formControl]="extendedSearch.controls['searchQueryType']"
            placeholder="Bereich"
          >
            <mat-option
              *ngFor="let searchOption of SearchOption | keyvalue"
              [value]="searchOption.value"
            >
              {{ searchOption.value }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="right">
        <mat-icon
          (click)="addSearchOption()"
          matTooltip="Hinzufügen"
          class="filter-icon"
        >
          add
        </mat-icon>
      </div>

      <span class="middle">
        <mat-form-field class="search">
          <label>
            <input
              (keyup.enter)="addSearchOption()"
              [formControl]="extendedSearch.controls['searchQuery']"
              matInput
              placeholder="Suche"
              id="searchQuery"
              name="searchQuery"
            />
          </label>
        </mat-form-field>
      </span>

      <div class="hint">
        <small
          *ngIf="
            extendedSearch.controls['searchQueryType'].value ===
            SearchOption.Tag
          "
        >
          <b>Hinweis:</b>

          <i>
            Es können mehrere Tags gleichzeitig hinzugefügt werden, indem diese
            durch Kommas getrennt werden.
          </i>
        </small>

        <small
          *ngIf="
            extendedSearch.controls['searchQueryType'].value ===
            SearchOption.Betreuer
          "
        >
          <b>Hinweis:</b>

          <i>
            Es können mehrere Betreuer gleichzeitig hinzugefügt werden, indem
            diese durch Kommas getrennt werden.
          </i>
        </small>
      </div>
    </div>

    <mat-divider></mat-divider>
  </div>

  <app-project-item
    *ngFor="let project of projects"
    (editButtonClicked)="openProjectEditorDialog(project)"
    (deleteButtonClicked)="deleteProject(project)"
    [showEditButton]="hasPermission"
    [showDeleteButton]="hasPermission"
    [project]="project"
  ></app-project-item>

  <mat-paginator
    (page)="changePageIndexOrSize($event)"
    [length]="totalProjects"
    [pageSize]="pageSize"
    [pageIndex]="pageIndex"
    [pageSizeOptions]="[10, 25, 50]"
  ></mat-paginator>
</div>
