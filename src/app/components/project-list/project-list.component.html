<div class="project-list">
  <div class="project-list-header">
    <h1>Projekte</h1>
    <div class="project-options">
      <mat-form-field>
        <mat-select (selectionChange)="filterProjectsByStatus($event)" placeholder="Status">
          <mat-option>Alle</mat-option>
          <mat-option *ngFor="let status of allStatus" [value]="status">{{
            status.charAt(0).toUpperCase() + status.slice(1).toLowerCase()
          }}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field>
        <input (keyup)="filterProjectsByName($event)" matInput placeholder="Suche" />
      </mat-form-field>
      <button
        (click)="openProjectDialog(null)"
        *ngIf="hasPermission"
        class="no-hover"
        mat-icon-button
      >
        <mat-icon>add</mat-icon>
      </button>
    </div>
  </div>

  <mat-card *ngFor="let project of projects">
    <mat-card-header>
      <mat-card-title matTooltip="Projekttitel">{{ project.name }}</mat-card-title>
      <mat-card-subtitle>
        <div
          matTooltip="Projektstatus"
          [class.abgeschlossen]="project.status === 'ABGESCHLOSSEN'"
          [class.geplant]="project.status === 'VERFÜGBAR'"
          class="status"
        >
          {{ project.status.charAt(0).toUpperCase() + project.status.slice(1).toLowerCase() }}
        </div>
        <span class="supervisorName" matTooltip="Projektbetreuer"
          ><b>{{ project.supervisorName }}</b></span
        >
      </mat-card-subtitle>
    </mat-card-header>
    <mat-divider></mat-divider>
    <mat-card-content>
      <mat-card-subtitle>Kurze Projektbeschreibung:</mat-card-subtitle>
      <p>{{ project.shortDescription }}</p>
      <div class="card-container-wrapper">
        <div class="card-container">
          <mat-card-subtitle>Teilnahmevoraussetzungen: </mat-card-subtitle>
          <p *ngIf="!project.requirement">Keine Teilnahmevoraussetzungen</p>
          <p>{{ project.requirement }}</p>
        </div>
        <div class="card-container">
          <mat-card-subtitle>Projekttypen:</mat-card-subtitle>
          <p>
            <span
              *ngFor="let module of project.modules; let i = index; let lst = last"
              matTooltip="Projekttyp {{ i + 1 }}: '{{ module.name }}'"
              >(<b>{{ module.projectType }}</b
              >) {{ module.name }} <span *ngIf="!lst">, </span></span
            >
          </p>
        </div>
      </div>
      <mat-card-subtitle>
        <mat-chip-list>
          <mat-chip
            color="primary"
            selected
            *ngFor="let tag of project.tags; let i = index"
            matTooltip="Tag {{ i + 1 }}: '{{ tag.tagName }}'"
            >{{ tag.tagName }}</mat-chip
          >
          <mat-chip color="primary" selected *ngIf="!project.tags.length"
            >Keine Tags vorhanden</mat-chip
          >
        </mat-chip-list>
      </mat-card-subtitle>
    </mat-card-content>
    <mat-divider></mat-divider>
    <mat-card-actions>
      <button
        mat-button
        routerLink="/projects/{{ project.id }}"
        matTooltip="Weiterführende Projektdetails"
      >
        Projektdetails
      </button>
      <button
        (click)="deleteProject(project)"
        *ngIf="hasPermission"
        class="no-hover"
        id="project-remove-button"
        mat-icon-button
      >
        <mat-icon>delete_forever</mat-icon>
      </button>
      <button
        (click)="openProjectDialog(project)"
        *ngIf="hasPermission"
        class="no-hover"
        id="project-edit-button"
        mat-icon-button
      >
        <mat-icon>edit</mat-icon>
      </button>
    </mat-card-actions>
  </mat-card>
  <mat-paginator
    [length]="totalProjects"
    [pageSize]="pageSize"
    [pageSizeOptions]="[10, 25, 50]"
    (page)="pageEvent($event)"
  >
  </mat-paginator>
</div>
